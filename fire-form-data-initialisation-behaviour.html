<link rel="import" href="../polymer/polymer.html">

<script>

    /**
     * @demo demo/index.html
     * @polymerBehavior
     */
    Polymer.FireFormDataInitialisationBehavior = {

        properties: {
            data: {
                type: Object,
                notify: true
            },
            dataOri: Object
        },

        // --- Logic Initialisation
        // --- ---------------------
        _entityIdChanged: function () {
            if (this.entityId === null) {
                // Blank case, no model to create
                this.setData(null);
            } else if (this.entityId === '' || this.entityId === 'new') {
                // Create Model
                this.createEmptyEntity();
                console.log('_entityIdChanged create empty data ', this.data);
            } else if (!this.data || !this.data._id || this.data._id !== this.entityId) {
                // Update Mode
                this.entityGet();
                //  console.log('entityidChanged load data ', this.entityid);
            }
        },
        // --- Apis
        // --- ---------------------
        save: function () {

        },

        // --- External Apis
        // --- ---------------------
        entityGet: function () {
            throw new Error('Not Implemented');
        },
        entityUpdate: function () {
            throw new Error('Not Implemented');
        },
        entitySave: function () {
            throw new Error('Not Implemented');
        },

        // --- Entity Create
        // --- ---------------------
        createEmptyEntity: function () {
            return {
                _id: null,
                _version: null,
                _source: {}
            };
        },

        setData: function (data) {
            this.set('data', data);
            this.dataSnapshot(data);
        },
        // --- Data Snapshot
        // --- ---------------------
        dataSnapshot: function (data) {
            if (data) {
                this.set('dataOri', JSON.parse(JSON.stringify(data)));
            } else {
                this.set('dataOri', null);
            }
        },


    };
</script>
