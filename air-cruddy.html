<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="air-cruddy-mixin.html">

<!--
`air-cruddy`
An Polymer element that manage CRUD Operations

The `air-cruddy` provides lightweight way to implement all CRUD (Create, Retrieve, Update, Delete) Operations on an REST Api with all the expected services :
 - Validation
 - Conflict Resolution on 409
 - Auto Save Feature

@group air-elements
@demo demo/index.html
-->

<dom-module id="air-cruddy">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <h2>Hello [[endpoint]]</h2>
  </template>

  <script>
    customElements.define('air-cruddy', class extends Polymer.Element {
      static get is() { return 'air-cruddy'; }

      static get config() {
        return {
          properties: {
            endpoint: {
              type: String,
              value: 'air-cruddy'
            },
            entityId: {
              type: String,
              notify: true
            },
            data: {
              type: Object
            }
          }
        };
      }

        // --- Changed Observer
        // --- ---------------------------


        // --- API Adapter
        // --- ---------------------------

        _fetchOptDefault(){
          let opt =    {
              mode: 'cors',
              cache: 'default'
          };
          return opt;
        };

        _fetchOptCreate(){
            let opt = this._fetchOptDefault();
            opt.method= 'PUT';
            return opt;
        };

        _fetchOptRetrieve(){
            let opt = this._fetchOptDefault();
            opt.method= 'GET';
            return opt;
        };

        _fetchOptUpdate(){
            let opt = this._fetchOptDefault();
            opt.method= 'PUT';
            return opt;
        };

        _fetchOptDelete(){
            let opt = this._fetchOptDefault();
            opt.method= 'DELETE';
            return opt;
        };


        // --- API
        // --- ---------------------------

        _fetchPromise(url, init) {
            return fetch(url, init).then(response => {
                return response.json();
            });
        };


    });
  </script>
</dom-module>
